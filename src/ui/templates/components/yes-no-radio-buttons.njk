{% from 'govuk/components/radios/macro.njk' import govukRadios %}

{% macro render(params) %}

  {% set fieldId = params.fieldId %}
  {% set heading = params.heading %}
  {% set hintText = params.hintText %}
  {% set hintHtml = params.hintHtml %}
  {% set submittedAnswer = params.submittedAnswer %}
  {% set errorMessage = params.errorMessage %}
  {% set yesNoValueString = params.yesNoValueString %}
  {% set conditionalYesHtml = params.conditionalYesHtml %}
  {% set conditionalNoHtml = params.conditionalNoHtml %}

  {% if params.headingLevel %}
    {% set headingLevel = params.headingLevel %}
  {% else %}
    {% set headingLevel = 1 %}
  {% endif %}

  {% if params.headingClass %}
    {% set headingClass = params.headingClass %}
  {% else %}
    {% set headingClass = 'govuk-heading-l' %}
  {% endif %}

  {% if params.dataCyLegend %}
    {% set dataCyLegend = params.dataCyLegend %}
  {% else %}
    {% set dataCyLegend = 'heading' %}
  {% endif %}

  {% if params.spanLegend %}
    {% set legendHtml = "<span data-cy='" + dataCyLegend + "' class='" + headingClass + "'>" + heading + "</span>" %}

  {% else %}
    {% set legendHtml = "<h" + headingLevel + " class=" + headingClass + " id='heading' data-cy='" + dataCyLegend + "'>" + heading + "</h" + headingLevel + ">" %}
  {% endif %}

  {% if params.dataCyHint %}
    {% set dataCyHint = params.dataCyHint %}
  {% else %}
    {% set dataCyHint = 'yes-no-input-hint' %}
  {% endif %}

  {% set yesValue = true %}
  {% set noValue = false %}

  {% if yesNoValueString %}
    {% set yesValue = 'Yes' %}
    {% set noValue = 'No' %}
  {% endif %}

  {% if not params.horizontalRadios %}
    {% set radioClass = 'govuk-radios--inline' %}
  {% endif %}

  {{ govukRadios({
    classes: radioClass,
    idPrefix: fieldId,
    name: fieldId,
    fieldset: {
      legend: {
        html: legendHtml
      }
    },
    hint: {
      text: hintText,
      html: hintHtml,
      attributes: {
        'data-cy': dataCyHint
      }
    },
    items: [
      {
        value: yesValue,
        text: "Yes",
        label: {
          attributes: {
            "data-cy": "yes"
          }
        },
        conditional: {
          html: conditionalYesHtml
        },
        attributes: {
          "data-cy": "yes-input",
          'aria-label': heading + ' Yes'
        },
        checked: submittedAnswer === yesValue
      },
      {
        value: noValue,
        text: "No",
        label: {
          attributes: {
            "data-cy": "no"
          }
        },
        conditional: {
          html: conditionalNoHtml
        },
        attributes: {
          "data-cy": "no-input",
          'aria-label': heading + ' No'
        },
        checked: submittedAnswer === noValue
      }
    ],
    errorMessage: errorMessage and {
      text: errorMessage.text,
      attributes: {
        "data-cy": "inline-error-message"
      }
    }
  }) }}

{% endmacro %}
