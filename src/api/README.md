# Export Insurance Policies API

GraphQL API for EXIP accounts and applications. This API is built with [Keystone](https://keystonejs.com/).

## Â Prerequisite

- Node version 16.17.0 or higher with a corresponding `npm`.
- An empty MySQL database.
- Make sure you have an `.env` Use `.env.sample` as a base. These variables are required to run the API.
- The DATABASE_URL environment variable should be pointing to your local MySQL database. e.g: `mysql://root:@localhost:1234/db-name`.
- Run `npm install` in this directory.

:warning: There is currently an issue with Keystone and `npm install` due to [duplicate graphql versions](https://github.com/keystonejs/keystone/issues/7816) which is why we currently have graphql overrides in the package.json.

## Running locally

1. Execute `npm run dev` or `npm run build && npm run start`.
2. GraphQL API is now available on [http://localhost:5001/api/graphql](http://localhost:5001/api/graphql).

GraphQL playground is also setup with the same URL.

## Using the Keystone admin UI

When running the API/Keystone for the first time, you will need to create a new user. This will give you admin rights in the admin UI.

## Files that should not be changed

The following files are automatically generated by Keystone and should not be manually changed:

- `/schema.graphql`
- `/schema.prisma`

## Documentation

This GraphQL API can generate documentation by using [spectaql](https://github.com/anvilco/spectaql).

The config file (`/documentation/config.yml`) reads the GraphQL schema (generated by Keystone) and generates a simple documentation UI.

To generate the documentation:

```shell
npm run documentation
```

The documentation will be in `/documentation/output`
