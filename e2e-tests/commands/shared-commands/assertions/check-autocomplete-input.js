const checkAutocompleteInput = {
  isVisible: (field) => {
    field.input().should('be.visible');
  },
  isNotVisible: (field) => {
    field.input().should('not.be.visible');
  },
  hasWorkingClientSideJS: (field) => {
    field.input().should('have.class', 'autocomplete__input');
  },
  rendersInput: (field) => {
    field.input().should('exist');
  },
  rendersNoResultsMessage: (field, input) => {
    cy.keyboardInput(field.input(), input);

    const noResults = field.noResults();
    noResults.should('exist');

    // this text is generated by external component.
    cy.checkText(noResults, 'No results found');
  },
  rendersSingleResult: (field, input) => {
    // start searching for a country
    cy.keyboardInput(field.input(), input);

    const noResults = field.noResults();
    noResults.should('not.exist');

    const results = field.results();

    results.should('have.length', 1);
  },
  rendersMultipleResults: (field) => {
    cy.keyboardInput(field.input(), 'A');

    const noResults = field.noResults();
    noResults.should('not.exist');

    const results = field.results();

    results.should('have.length.greaterThan', 1);
  },
  allowsUserToRemoveCountryAndSearchAgain: (field, country1, country2, expectedValue) => {
    cy.keyboardInput(field.input(), country1);
    const results = field.results();

    // select the first result
    results.first().click();

    // clear the input
    field.input().clear();

    // search for a different country, submit with enter key
    cy.keyboardInput(field.input(), `${country2}{enter}`);

    cy.checkText(field.results(), expectedValue);
  },
};

export default checkAutocompleteInput;
